---
title: Hardware Discovery API
description: API reference for HORUS hardware discovery system
---

# Hardware Discovery API

The `horus::prelude` includes comprehensive hardware discovery types for detecting and identifying connected robotics hardware.

## Core Types

### HardwareDiscovery

Main entry point for hardware discovery.

```rust
use horus::prelude::*;

let discovery = HardwareDiscovery::new()?;
let report = discovery.scan_all();
```

#### Methods

| Method | Description |
|--------|-------------|
| `new() -> Result<Self>` | Create new discovery instance |
| `platform() -> Platform` | Get detected platform |
| `database() -> &DeviceDatabase` | Access device identification database |
| `scan_all() -> DiscoveryReport` | Scan all hardware categories |
| `scan_with_options(&DiscoveryOptions) -> DiscoveryReport` | Scan with custom options |

---

### DiscoveryOptions

Configure what and how to scan.

```rust
let options = DiscoveryOptions::default()
    .with_categories(CategoryFilter::only(&[
        DeviceCategory::Camera,
        DeviceCategory::Lidar,
    ]))
    .with_timeout(Duration::from_secs(5))
    .with_i2c_probe(true);
```

#### Builder Methods

| Method | Description |
|--------|-------------|
| `with_categories(CategoryFilter)` | Filter device categories |
| `with_timeout(Duration)` | Set scan timeout |
| `with_i2c_probe(bool)` | Enable/disable I2C probing |
| `with_parallel(bool)` | Enable parallel scanning |

---

### DiscoveryReport

Results from a hardware scan.

```rust
let report = discovery.scan_all();
println!("Found {} USB devices", report.usb_devices.len());
println!("{}", report.summary());
```

#### Fields

| Field | Type | Description |
|-------|------|-------------|
| `platform` | `Platform` | Detected platform |
| `usb_devices` | `Vec<UsbDevice>` | USB devices found |
| `serial_ports` | `Vec<SerialPort>` | Serial ports found |
| `i2c_buses` | `Vec<I2cBus>` | I2C buses and devices (Linux) |
| `spi_buses` | `Vec<SpiBus>` | SPI buses (Linux) |
| `can_interfaces` | `Vec<CanInterface>` | CAN interfaces (Linux) |
| `gpio_chips` | `Vec<GpioChip>` | GPIO chips (Linux) |
| `pwm_chips` | `Vec<PwmChip>` | PWM chips (Linux) |
| `cameras` | `Vec<Camera>` | Video capture devices (Linux) |
| `bluetooth_adapters` | `Vec<BluetoothAdapter>` | Bluetooth adapters (Linux) |
| `network_interfaces` | `Vec<NetworkInterface>` | Network interfaces (Linux) |
| `audio_cards` | `Vec<AudioCard>` | Audio cards (Linux) |

#### Methods

| Method | Description |
|--------|-------------|
| `summary() -> DiscoverySummary` | Get summary statistics |
| `total_devices() -> usize` | Total device count |
| `to_json() -> String` | Serialize to JSON |

---

### DiscoverySummary

Summary statistics from a scan.

```rust
let summary = report.summary();
println!("USB: {}", summary.usb_count);
println!("I2C: {} devices on {} buses", summary.i2c_device_count, summary.i2c_bus_count);
```

#### Fields

| Field | Type | Description |
|-------|------|-------------|
| `usb_count` | `usize` | USB device count |
| `serial_count` | `usize` | Serial port count |
| `i2c_bus_count` | `usize` | I2C bus count |
| `i2c_device_count` | `usize` | I2C device count |
| `spi_bus_count` | `usize` | SPI bus count |
| `can_interface_count` | `usize` | CAN interface count |
| `gpio_chip_count` | `usize` | GPIO chip count |
| `gpio_line_count` | `usize` | GPIO line count |
| `camera_count` | `usize` | Camera count |
| `network_count` | `usize` | Network interface count |
| `audio_count` | `usize` | Audio card count |

---

### DiscoveredDevice

Unified device representation.

```rust
pub struct DiscoveredDevice {
    pub name: String,
    pub category: DeviceCategory,
    pub path: Option<PathBuf>,
    pub vendor_id: Option<u16>,
    pub product_id: Option<u16>,
    pub serial_number: Option<String>,
    pub driver: Option<String>,
}
```

---

### CategoryFilter

Filter for device categories.

```rust
// Only specific categories
let filter = CategoryFilter::only(&[DeviceCategory::Camera, DeviceCategory::Lidar]);

// All except certain categories
let filter = CategoryFilter::except(&[DeviceCategory::Audio, DeviceCategory::Bluetooth]);

// All categories (default)
let filter = CategoryFilter::all();
```

---

## Platform Types

### Platform

Detected platform type.

```rust
pub enum Platform {
    RaspberryPi3,
    RaspberryPi4,
    RaspberryPi5,
    JetsonNano,
    JetsonXavier,
    JetsonOrin,
    BeagleBoneBlack,
    BeagleBoneAI,
    IntelNuc,
    GenericLinux,
    Unknown,
}
```

#### Methods

| Method | Description |
|--------|-------------|
| `name() -> &str` | Human-readable name |
| `is_raspberry_pi() -> bool` | Check if Raspberry Pi |
| `is_jetson() -> bool` | Check if NVIDIA Jetson |
| `is_beaglebone() -> bool` | Check if BeagleBone |

---

### PlatformCapabilities

Platform hardware capabilities.

```rust
pub struct PlatformCapabilities {
    pub has_gpio: bool,
    pub has_i2c: bool,
    pub has_spi: bool,
    pub has_can: bool,
    pub has_pwm: bool,
    pub has_uart: bool,
    pub cpu_cores: u8,
    pub cpu_freq_mhz: Option<u32>,
    pub memory_mb: Option<u32>,
    pub gpu: Option<GpuType>,
}
```

---

### GpuType

GPU type enumeration.

```rust
pub enum GpuType {
    VideoCore4,      // Raspberry Pi 3
    VideoCore6,      // Raspberry Pi 4
    VideoCore7,      // Raspberry Pi 5
    NvidiaTegra,     // Jetson Nano
    NvidiaXavier,    // Jetson Xavier
    NvidiaOrin,      // Jetson Orin
    IntelIntegrated,
    AmdIntegrated,
    Unknown,
}
```

---

## Device Database

### DeviceDatabase

USB VID/PID device identification database.

```rust
let db = DeviceDatabase::new();
let info = db.lookup_usb(0x10C4, 0xEA60); // Silicon Labs CP210x

if let Some(info) = info {
    println!("Device: {} ({:?})", info.name, info.category);
}
```

#### Methods

| Method | Description |
|--------|-------------|
| `new() -> Self` | Create with built-in database |
| `lookup_usb(vid, pid) -> Option<&DeviceInfo>` | Lookup by VID/PID |
| `lookup_i2c(address) -> Option<&DeviceInfo>` | Lookup I2C by address |
| `get_vendor(vid) -> Option<&str>` | Get vendor name |
| `devices_by_category(cat) -> Vec<&DeviceInfo>` | Get all devices in category |

---

### DeviceCategory

Device classification.

```rust
pub enum DeviceCategory {
    Microcontroller,
    SerialAdapter,
    MotorController,
    ServoController,
    Lidar,
    DepthCamera,
    Camera,
    Imu,
    Gps,
    CanAdapter,
    Joystick,
    Bluetooth,
    Audio,
    Network,
    Power,
    Display,
    Storage,
    Other,
}
```

#### Methods

| Method | Description |
|--------|-------------|
| `name() -> &str` | Human-readable name |

---

### DeviceInfo

Information about a known device.

```rust
pub struct DeviceInfo {
    pub name: String,
    pub vendor: String,
    pub category: DeviceCategory,
    pub driver: Option<String>,
    pub notes: Option<String>,
}
```

---

### DriverMatch

Driver recommendation for a device.

```rust
pub struct DriverMatch {
    pub driver_name: String,
    pub confidence: MatchConfidence,
    pub feature_flag: Option<String>,
}
```

---

### MatchConfidence

Confidence level for driver match.

```rust
pub enum MatchConfidence {
    Exact,     // Exact VID/PID match
    High,      // Same vendor, similar device
    Medium,    // Generic driver
    Low,       // Best guess
}
```

---

## USB Types

### UsbDevice

USB device information.

```rust
pub struct UsbDevice {
    pub vendor_id: u16,
    pub product_id: u16,
    pub vendor: Option<String>,
    pub product: Option<String>,
    pub serial_number: Option<String>,
    pub bus_number: u8,
    pub device_address: u8,
    pub device_class: u8,
    pub device_subclass: u8,
    pub serial_port: Option<String>,  // e.g., "/dev/ttyUSB0"
}
```

---

### UsbDiscovery

USB device scanner.

```rust
let mut usb = UsbDiscovery::new();
let devices = usb.enumerate_devices();
```

---

## Serial Types

### SerialPort

Serial port information.

```rust
pub struct SerialPort {
    pub path: PathBuf,
    pub port_type: SerialPortType,
    pub vendor_id: Option<u16>,
    pub product_id: Option<u16>,
    pub product: Option<String>,
    pub serial_number: Option<String>,
}
```

---

### SerialPortType

Serial port type.

```rust
pub enum SerialPortType {
    UsbSerial,      // USB-to-serial adapter
    PciSerial,      // PCI serial card
    PlatformUart,   // Built-in UART (e.g., /dev/ttyAMA0)
    Bluetooth,      // Bluetooth serial
    Unknown,
}
```

---

## Linux-Specific Types

*Available when `target_os = "linux"`*

### I2C Types

```rust
pub struct I2cBus {
    pub bus_number: u8,
    pub path: PathBuf,
    pub devices: Vec<I2cDevice>,
}

pub struct I2cDevice {
    pub address: u8,
    pub name: Option<String>,
    pub driver: Option<String>,
}
```

### SPI Types

```rust
pub struct SpiBus {
    pub bus_number: u8,
    pub chip_selects: Vec<SpiChipSelect>,
}

pub struct SpiChipSelect {
    pub chip_select: u8,
    pub device_path: PathBuf,
}
```

### CAN Types

```rust
pub struct CanInterface {
    pub name: String,
    pub interface_type: CanInterfaceType,
    pub state: CanState,
    pub bitrate: Option<u32>,
}

pub enum CanInterfaceType {
    SocketCan,
    Slcan,
    Virtual,
}

pub enum CanState {
    Up,
    Down,
    Error,
}
```

### GPIO Types

```rust
pub struct GpioChip {
    pub name: String,
    pub label: String,
    pub num_lines: u32,
    pub path: PathBuf,
    pub lines: Vec<GpioLine>,
}

pub struct GpioLine {
    pub offset: u32,
    pub name: String,
    pub consumer: Option<String>,
    pub direction: Option<String>,
}
```

### PWM Types

```rust
pub struct PwmChip {
    pub chip_number: u8,
    pub num_channels: u8,
    pub path: PathBuf,
    pub channels: Vec<PwmChannel>,
}

pub struct PwmChannel {
    pub channel_number: u8,
    pub enabled: bool,
    pub period: Option<u64>,
    pub duty_cycle: Option<u64>,
    pub polarity: PwmPolarity,
    pub frequency: Option<u32>,
}

pub enum PwmPolarity {
    Normal,
    Inversed,
}
```

### Camera Types

```rust
pub struct Camera {
    pub name: String,
    pub device_path: PathBuf,
    pub camera_type: CameraType,
    pub driver: Option<String>,
    pub formats: Vec<VideoFormat>,
}

pub enum CameraType {
    Usb,
    Csi,
    Pci,
    Virtual,
}

pub struct VideoFormat {
    pub pixel_format: String,
    pub width: u32,
    pub height: u32,
    pub fps: u32,
}
```

### Bluetooth Types

```rust
pub struct BluetoothAdapter {
    pub name: String,
    pub address: String,
    pub adapter_type: BluetoothAdapterType,
    pub state: BluetoothState,
    pub devices: Vec<BluetoothDevice>,
}

pub struct BluetoothDevice {
    pub name: String,
    pub address: String,
    pub device_class: BluetoothDeviceClass,
    pub connected: bool,
    pub paired: bool,
}
```

### Network Types

```rust
pub struct NetworkInterface {
    pub name: String,
    pub interface_type: NetworkInterfaceType,
    pub state: NetworkState,
    pub mac_address: Option<String>,
    pub ip_address: Option<String>,
    pub wifi_info: Option<WifiInfo>,
}

pub struct WifiInfo {
    pub ssid: String,
    pub signal_strength: i32,
    pub frequency: u32,
}
```

### Audio Types

```rust
pub struct AudioCard {
    pub card_number: u8,
    pub card_id: String,
    pub card_name: String,
    pub device_type: AudioDeviceType,
    pub driver: Option<String>,
    pub devices: Vec<AudioDevice>,
}

pub struct AudioDevice {
    pub card_number: u8,
    pub device_number: u8,
    pub device_name: String,
    pub direction: AudioDirection,
    pub device_path: String,
}

pub enum AudioDirection {
    Playback,
    Capture,
    Duplex,
}
```

---

## See Also

- [Hardware Discovery Guide](/development/hardware-discovery) - Usage guide and examples
- [Hardware Drivers](/rust/library/drivers) - Low-level driver implementations
- [Built-in Nodes](/rust/library/built-in-nodes) - Pre-built hardware nodes
